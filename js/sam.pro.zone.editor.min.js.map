{"version":3,"sources":["../js-src/sam.pro.zone.editor.js"],"names":[],"mappings":"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","file":"sam.pro.zone.editor.min.js","sourcesContent":["/**\r\n * Created by minimus on 26.06.2015.\r\n */\r\nconst zoneRules = options.rules.rules;\r\nconst singleRules = options.rules.single;\r\nconst item = options.item;\r\nconst places = options.places;\r\nconst pageSize = options.itemsPerPage;\r\n\r\n(function($) {\r\n  const ejLocale = (options.locale.changeLocale) ? options.locale.locale : 'en-US';\r\n  const localeStrings = options.strings;\r\n  $(document).ready(function() {\r\n    let dmRules;\r\n    let dmSRules;\r\n    let rulesGrid;\r\n    let sRulesGrid;\r\n    const rulesDialog = $('#rulesDialog').ejDialog({\r\n      width: 830,\r\n      allowDraggable: true,\r\n      enableModal: true,\r\n      showOnInit: false\r\n    }).data('ejDialog');\r\n    const singleDialog = $('#singleDialog').ejDialog({\r\n      width: 830,\r\n      allowDraggable: true,\r\n      enableModal: true,\r\n      showOnInit: false\r\n    }).data('ejDialog');\r\n    const rulesSel = new Selectors();\r\n    const singleSel = new Selectors();\r\n\r\n    rulesSel.sid = ''; singleSel.sid = '';\r\n    rulesGrid = $('#rulesGrid').ejGrid({\r\n      dataSource: zoneRules,\r\n      locale: ejLocale,\r\n      allowSorting: true,\r\n      allowSelection: true,\r\n      selectionType: ej.Grid.SelectionType.Multiple,\r\n      selectionSettings: {\r\n        selectionMode: [ej.Grid.SelectionMode.Row],\r\n        enableToggle: true\r\n      },\r\n      allowPaging: true,\r\n      pageSettings: {\r\n        pageSize: pageSize\r\n      },\r\n      columns: [\r\n        {field: 'slug', visible: false},\r\n        {field: 'tax', headerText: localeStrings.type},\r\n        {field: 'name', headerText: localeStrings.name},\r\n        {field: 'term_slug', visible: false},\r\n        {field: 'priority', visible: false}\r\n      ],\r\n      rowSelected: function(args) {\r\n        if(!rulesSel.service) {\r\n          rulesSel.page = args.model.pageSettings.currentPage;\r\n          const d = rulesSel.pids[rulesSel.page].slice(0);\r\n          const cr = d.indexOf(args.data.slug);\r\n          if(cr > -1) rulesSel.removePid(args.data.slug);\r\n          else rulesSel.pids = args.data.slug;\r\n        }\r\n      },\r\n      actionComplete: function(args) {\r\n        const d = rulesSel.ids.slice(0);\r\n        rulesSel.service = true;\r\n        if(d.length !== 0) {\r\n          for(let i = 0; i < this.model.currentViewData.length; i++) {\r\n            for(let j = 0; j < d.length; j++) {\r\n              if(d[j] === this.model.currentViewData[i].slug) {\r\n                this.multiSelectCtrlRequest = true;\r\n                this.selectRows(i);\r\n                if(args.requestType === 'paging') {\r\n                  rulesSel.page = args.currentPage;\r\n                  rulesSel.pids = this.model.currentViewData[i].slug;\r\n                }\r\n                else if(args.requestType === 'refresh') {\r\n                  rulesSel.page = 1;\r\n                  rulesSel.pids = this.model.currentViewData[i].slug;\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        rulesSel.service = false;\r\n      }\r\n    }).data('ejGrid');\r\n\r\n    sRulesGrid = $('#singleGrid').ejGrid({\r\n      dataSource: singleRules,\r\n      locale: ejLocale,\r\n      allowSorting: true,\r\n      allowSelection: true,\r\n      selectionType: ej.Grid.SelectionType.Multiple,\r\n      selectionSettings: {\r\n        selectionMode: [ej.Grid.SelectionMode.Row],\r\n        enableToggle: true\r\n      },\r\n      allowPaging: true,\r\n      pageSettings: {\r\n        pageSize: pageSize\r\n      },\r\n      columns: [\r\n        {field: 'slug', visible: false},\r\n        {field: 'tax', headerText: localeStrings.type},\r\n        {field: 'name', headerText: localeStrings.name},\r\n        {field: 'term_slug', visible: false},\r\n        {field: 'priority', visible: false}\r\n      ],\r\n      rowSelected: function(args) {\r\n        if(!singleSel.service) {\r\n          singleSel.page = args.model.pageSettings.currentPage;\r\n          const d = singleSel.pids[singleSel.page].slice(0);\r\n          const cr = d.indexOf(args.data.slug);\r\n          if(cr > -1) singleSel.removePid(args.data.slug);\r\n          else singleSel.pids = args.data.slug;\r\n        }\r\n      },\r\n      actionComplete: function(args) {\r\n        const d = singleSel.ids.slice(0);\r\n        singleSel.service = true;\r\n        if(d.length !== 0) {\r\n          for(let i = 0; i < this.model.currentViewData.length; i++) {\r\n            for(let j = 0; j < d.length; j++) {\r\n              if(d[j] === this.model.currentViewData[i].slug) {\r\n                this.multiSelectCtrlRequest = true;\r\n                this.selectRows(i);\r\n                if(args.requestType === 'paging') {\r\n                  singleSel.page = args.currentPage;\r\n                  singleSel.pids = this.model.currentViewData[i].slug;\r\n                }\r\n                else if(args.requestType === 'refresh') {\r\n                  singleSel.page = 1;\r\n                  singleSel.pids = this.model.currentViewData[i].slug;\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        singleSel.service = false;\r\n      }\r\n    }).data('ejGrid');\r\n\r\n    $('#cancel-rules').on('click', () => (rulesDialog.close()));\r\n\r\n    $('#select-rules').on('click', (e) => {\r\n      e.preventDefault();\r\n\r\n      const rules = rulesSel.sid;\r\n      const aRules = rules.split(',');\r\n      const data = [];\r\n      for(let i = 0; i < aRules.length; i++) {\r\n        data.push(zoneRules.find(function(el, idx, a) {\r\n          return (el.slug === aRules[i]);\r\n        }));\r\n      }\r\n      if(data.length > 0) {\r\n        $.post(ajaxurl, {\r\n          action: 'add_zone_rules',\r\n          zid: item,\r\n          rules: data,\r\n          sam_pro_nonce: options.samProNonce\r\n        }).done(() => {\r\n          generalGrid.refreshContent();\r\n        });\r\n      }\r\n\r\n      rulesDialog.close();\r\n    });\r\n\r\n    $('#cancel-single').on('click', () => (singleDialog.close()));\r\n\r\n    $('#select-single').on('click', (e) => {\r\n      e.preventDefault();\r\n\r\n      const rules = singleSel.sid;\r\n      const aRules = rules.split(',');\r\n      const data = [];\r\n      for(let i = 0; i < aRules.length; i++) {\r\n        data.push(singleRules.find(function(el, idx, a) {\r\n          return (el.slug === aRules[i]);\r\n        }));\r\n      }\r\n      if(data.length > 0) {\r\n        $.post(ajaxurl, {\r\n          action: 'add_zone_single_rules',\r\n          zid: item,\r\n          rules: data,\r\n          sam_pro_nonce: options.samProNonce\r\n        }).done(() => (singleGrid.refreshContent()));\r\n      }\r\n\r\n      singleDialog.close();\r\n    });\r\n\r\n    const dmGeneral = ej.DataManager({\r\n      url: ajaxurl + '?action=load_zone_rules&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      updateUrl: ajaxurl + '?action=update_zone_rule&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      removeUrl: ajaxurl + '?action=remove_zone_rule&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      requestType: 'json',\r\n      adaptor: new ej.UrlAdaptor()\r\n    });\r\n    const dmSingle = ej.DataManager({\r\n      url: ajaxurl + '?action=load_zone_single_rules&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      updateUrl: ajaxurl + '?action=update_zone_single_rule&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      removeUrl: ajaxurl + '?action=remove_zone_single_rule&item=' + item + '&sam_pro_nonce=' + options.samProNonce,\r\n      requestType: 'json',\r\n      adaptor: new ej.UrlAdaptor()\r\n    });\r\n\r\n    const generalGrid = $('#aGrid').ejGrid({\r\n      dataSource: dmGeneral,\r\n      locale: ejLocale,\r\n      allowSorting: true,\r\n      allowSelection: true,\r\n      selectionType: ej.Grid.SelectionType.Single,\r\n      selectionSettings: {\r\n        selectionMode: [ej.Grid.SelectionMode.Row],\r\n        enableToggle: true\r\n      },\r\n      allowPaging: true,\r\n      pageSettings: {\r\n        pageSize: pageSize\r\n      },\r\n      editSettings: {allowEditing: true, allowDeleting: true, showDeleteConfirmDialog: true},\r\n      toolbarSettings: {\r\n        showToolbar: true,\r\n        toolbarItems: [\r\n          ej.Grid.ToolBarItems.Edit,\r\n          ej.Grid.ToolBarItems.Update,\r\n          ej.Grid.ToolBarItems.Cancel,\r\n          ej.Grid.ToolBarItems.Delete\r\n        ],\r\n        customToolbarItems: [\r\n          'Refresh',\r\n          'Add'\r\n        ]\r\n      },\r\n      toolbarClick: function (args) {\r\n        const tBarObj = $(args.target);\r\n        if (tBarObj.hasClass(\"Refresh\")) {\r\n          this.refreshContent();\r\n        }\r\n        else if (tBarObj.hasClass('Add')) {\r\n          rulesDialog.open();\r\n        }\r\n      },\r\n      create: function (args) {\r\n        $('.Refresh').parent('li').attr('title', localeStrings.refresh);\r\n        $('.Add').parent('li').attr('title', localeStrings.add);\r\n      },\r\n      actionComplete: function (args) {\r\n        const $tb = $('#aGrid_toolbarItems');\r\n        let li;\r\n        li = $('#aGrid_delete');\r\n        $tb.ejToolbar('disableItem', li);\r\n      },\r\n      recordClick: function (args) {\r\n        const $tb = $('#aGrid_toolbarItems');\r\n        let li;\r\n        const recs = this.getSelectedRecords();\r\n        const action = (recs.length === 0) ? 'disableItem' : 'enableItem';\r\n        li = $('#aGrid_delete');\r\n        $tb.ejToolbar(action, li);\r\n      },\r\n      columns: [\r\n        {field: 'zid', allowEditing: false, visible: false},\r\n        {field: 'slug', headerText: localeStrings.slug, isPrimaryKey: true, allowEditing: false, visible: false},\r\n        {field: 'single', allowEditing: false, visible: false},\r\n        {\r\n          field: 'priority',\r\n          headerText: localeStrings.priority,\r\n          allowEditing: false,\r\n          visible: false,\r\n          width: 100\r\n        },\r\n        {field: 'tax', headerText: localeStrings.type, allowEditing: false/*, width: 220*/},\r\n        {field: 'name', headerText: localeStrings.name, allowEditing: false},\r\n        {field: 'term_slug', allowEditing: false, visible: false},\r\n        {\r\n          field: 'pid',\r\n          foreignKeyField: 'pid',\r\n          foreignKeyValue: 'title',\r\n          dataSource: places,\r\n          headerText: localeStrings.place,\r\n          visible: true\r\n        }\r\n      ]\r\n    }).data('ejGrid');\r\n\r\n    const singleGrid = $('#sGrid').ejGrid({\r\n      dataSource: dmSingle,\r\n      locale: ejLocale,\r\n      allowSorting: true,\r\n      allowSelection: true,\r\n      selectionType: ej.Grid.SelectionType.Single,\r\n      selectionSettings: {\r\n        selectionMode: [ej.Grid.SelectionMode.Row],\r\n        enableToggle: true\r\n      },\r\n      allowPaging: true,\r\n      pageSettings: {\r\n        pageSize: pageSize\r\n      },\r\n      editSettings: {allowEditing: true, allowDeleting: true, showDeleteConfirmDialog: true},\r\n      toolbarSettings: {\r\n        showToolbar: true,\r\n        toolbarItems: [\r\n          ej.Grid.ToolBarItems.Edit,\r\n          ej.Grid.ToolBarItems.Update,\r\n          ej.Grid.ToolBarItems.Cancel,\r\n          ej.Grid.ToolBarItems.Delete\r\n        ],\r\n        customToolbarItems: [\r\n          'Refresh',\r\n          'Add'\r\n        ]\r\n      },\r\n      toolbarClick: function (args) {\r\n        const tBarObj = $(args.target);\r\n        if (tBarObj.hasClass(\"Refresh\")) {\r\n          this.refreshContent();\r\n        }\r\n        else if (tBarObj.hasClass('Add')) {\r\n          singleDialog.open();\r\n        }\r\n      },\r\n      create: function (args) {\r\n        $('.Refresh').parent('li').attr('title', localeStrings.refresh);\r\n        $('.Add').parent('li').attr('title', localeStrings.add);\r\n      },\r\n      actionComplete: function (args) {\r\n        const $tb = $('#sGrid_toolbarItems');\r\n        let li;\r\n        li = $('#sGrid_delete');\r\n        $tb.ejToolbar('disableItem', li);\r\n      },\r\n      recordClick: function (args) {\r\n        const $tb = $('#sGrid_toolbarItems');\r\n        let li;\r\n        const recs = this.getSelectedRecords();\r\n        const action = (recs.length === 0) ? 'disableItem' : 'enableItem';\r\n        li = $('#sGrid_delete');\r\n        $tb.ejToolbar(action, li);\r\n      },\r\n      columns: [\r\n        {field: 'zid', allowEditing: false, visible: false},\r\n        {field: 'slug', headerText: localeStrings.slug, isPrimaryKey: true, allowEditing: false, visible: false},\r\n        {field: 'single', allowEditing: false, visible: false},\r\n        {\r\n          field: 'priority',\r\n          headerText: localeStrings.priority,\r\n          textAlign: ej.TextAlign.Right,\r\n          editType: ej.Grid.EditingType.Numeric,\r\n          width: 100\r\n        },\r\n        {field: 'tax', headerText: localeStrings.type, allowEditing: false},\r\n        {field: 'name', headerText: localeStrings.name, allowEditing: false},\r\n        {field: 'term_slug', allowEditing: false, visible: false},\r\n        {\r\n          field: 'pid',\r\n          foreignKeyField: 'pid',\r\n          foreignKeyValue: 'title',\r\n          dataSource: places,\r\n          headerText: localeStrings.place,\r\n          visible: true\r\n        }\r\n      ]\r\n    }).data('ejGrid');\r\n  });\r\n})(jQuery);"]}