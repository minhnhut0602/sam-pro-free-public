{"version":3,"sources":["../js-src/sam.pro.blocks.list.js"],"names":[],"mappings":"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","file":"sam.pro.blocks.list.min.js","sourcesContent":["/**\r\n * Created by minimus on 14.03.2015.\r\n */\r\n\r\n(function($) {\r\n  const ejLocale = (options.locale.changeLocale) ? options.locale.locale : 'en-US';\r\n  const localeStrings = options.strings;\r\n  $(document).ready(function() {\r\n    let lis;\r\n    const dm = ej.DataManager({\r\n      url: `${ajaxurl}?action=load_blocks&sam_pro_nonce=${options.samProNonce}`,\r\n      removeUrl: `${ajaxurl}?action=remove_block&sam_pro_nonce=${options.samProNonce}`,\r\n      requestType: 'json',\r\n      adaptor: new ej.UrlAdaptor()\r\n    });\r\n\r\n    const grid = $('#grid').ejGrid({\r\n      dataSource: dm,\r\n      locale: ejLocale,\r\n      allowTextWrap: true,\r\n      allowPaging: true,\r\n      allowSorting: true,\r\n      allowFiltering: true,\r\n      filterSettings: {filterType: 'menu'},\r\n      pageSettings: {pageSize: options.itemsPerPage},\r\n      allowSelection: true,\r\n      selectionSettings: {selectionMode: [ej.Grid.SelectionMode.Row], enableToggle: true},\r\n      editSettings: {allowDeleting: true, showDeleteConfirmDialog : true},\r\n      toolbarSettings: {\r\n        showToolbar: true,\r\n        toolbarItems: [\r\n          ej.Grid.ToolBarItems.Delete\r\n        ],\r\n        customToolbarItems: [\r\n          {templateID: '#viewMode'},\r\n          'Refresh',\r\n          {templateID: '#NewBlock'},\r\n          \"Edit\",\r\n          {templateID: \"#TrashBlock\"},\r\n          {templateID: \"#UnTrashBlock\"}\r\n        ]\r\n      },\r\n      toolbarClick: function (sender, args) {\r\n        const tbarObj = $(sender.target);\r\n        const rec = this.getSelectedRecords();\r\n        let bid;\r\n        if (tbarObj.hasClass(\"Refresh\"))\r\n          this.refreshContent();\r\n        if(tbarObj.hasClass('Edit')) {\r\n          if(rec.length > 0) {\r\n            const item = rec[0].bid;\r\n            document.location = options.editorUrl + item;\r\n          }\r\n        }\r\n        else if (tbarObj.hasClass('block-to-trash') || tbarObj.hasClass('block-from-trash')) {\r\n          const toFrom = ((tbarObj.hasClass('block-to-trash')) ? 1 : 0);\r\n          if (rec.length > 0) {\r\n            const trash = parseInt(rec[0].trash, 10);\r\n\r\n            bid = parseInt(rec[0].bid, 10);\r\n            if (trash !== toFrom) {\r\n              $.post(ajaxurl, {\r\n                action: 'trash_block',\r\n                bid: bid,\r\n                trash: toFrom,\r\n                sam_pro_nonce: options.samProNonce\r\n              }).done((data) => {\r\n                const sel = parseInt(ddList.getSelectedValue(), 10);\r\n                if (sel === 0) grid._disabledToolItems.push(lis[6]);\r\n                else if (sel === 1) grid._disabledToolItems.push(lis[5]);\r\n                grid.refreshContent();\r\n              });\r\n            }\r\n          }\r\n        }\r\n      },\r\n      create: function (args) {\r\n        const $toolbar = $('#grid_toolbarItems');\r\n        lis = $toolbar.find(\"li\");\r\n        $('.block-to-trash').parent('li').attr('title', localeStrings.moveToTrash);\r\n        $('.block-from-trash').parent('li').attr('title', localeStrings.restoreFromTrash);\r\n        $('li[title=\"viewMode\"]').attr('title', localeStrings.viewMode);\r\n        $('li[title=\"NewBlock\"]').attr('title', localeStrings.newBlock);\r\n        $('li[title=\"Edit\"]').attr('title', localeStrings.edit);\r\n        $('.Refresh').parent('li').attr('title', localeStrings.refresh);\r\n      },\r\n      actionComplete: function(args) {\r\n        const $tb = $('#grid_toolbarItems');\r\n        let li;\r\n        li = $('#grid_delete');\r\n        $tb.ejToolbar('disableItem', li);\r\n        li = $('#grid_Edit');\r\n        $tb.ejToolbar('disableItem', li);\r\n        li = $('#grid_TrashBlock');\r\n        $tb.ejToolbar('disableItem', li);\r\n        li = $('#grid_UnTrashBlock');\r\n        $tb.ejToolbar('disableItem', li);\r\n      },\r\n      recordClick: function(args) {\r\n        const $tb = $('#grid_toolbarItems');\r\n        let li;\r\n        const recs = this.getSelectedRecords();\r\n        const action = (recs.length === 0) ? 'disableItem' : 'enableItem';\r\n        li = $('#grid_delete');\r\n        $tb.ejToolbar(action, li);\r\n        li = $('#grid_Edit');\r\n        $tb.ejToolbar(action, li);\r\n        li = $('#grid_TrashBlock');\r\n        $tb.ejToolbar(action, li);\r\n        li = $('#grid_UnTrashBlock');\r\n        $tb.ejToolbar(action, li);\r\n      },\r\n      columns: [\r\n        {field: 'bid', headerText: localeStrings.bid, isPrimaryKey: true, textAlign: ej.TextAlign.Right, allowSorting: true, allowEditing: false, width: 100},\r\n        {field: 'title', headerText: localeStrings.name, allowSorting: true, allowEditing: false, width: 250},\r\n        {field: 'description', headerText: localeStrings.desc, allowSorting: true, allowEditing: false},\r\n        {field: 'size', headerText: localeStrings.size, textAlign: ej.TextAlign.Center, width: 100},\r\n        {field: 'stat', headerText: localeStrings.status, textAlign: ej.TextAlign.Center, allowSorting: false, allowEditing: false, allowFiltering: false, width: 100},\r\n        {field: 'trash', headerText: 'Status', allowEditing: false, visible: false}\r\n      ]\r\n    }).data('ejGrid');\r\n\r\n    const ddList = $('#view-mode').ejDropDownList({\r\n      selectedItemIndex: 0,\r\n      change: function (args) {\r\n        const sel = parseInt(this.getSelectedValue(), 10);\r\n        if (sel !== 10) {\r\n          $('#grid').ejGrid('model.query', new ej.Query().where('trash', ej.FilterOperators.equal, sel, 10));\r\n        }\r\n        else {\r\n          $('#grid').ejGrid('model.query', new ej.Query());\r\n        }\r\n        if (sel === 0) grid._disabledToolItems.push(lis[6]);\r\n        else if (sel === 1) grid._disabledToolItems.push(lis[5]);\r\n        grid.refreshContent(true);\r\n      }\r\n    }).data('ejDropDownList');\r\n  });\r\n})(jQuery);\r\n"]}