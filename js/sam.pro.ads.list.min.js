(function(n){var i=options.locale.changeLocale?options.locale.locale:"en-US",t=options.strings,r=options.samProAjaxModerate;n(document).ready(function(){var f,e=ej.DataManager({url:ajaxurl+"?action=load_ads&wap="+options.wap+"&sam_pro_nonce="+options.samProNonce,removeUrl:ajaxurl+"?action=remove_ad&wap="+options.wap+"&sam_pro_nonce="+options.samProNonce,requestType:"json",adaptor:new ej.UrlAdaptor}),u=n("#grid").ejGrid({dataSource:e,locale:i,allowTextWrap:!0,allowPaging:!0,allowSorting:!0,allowFiltering:!0,filterSettings:{filterType:"menu"},pageSettings:{pageSize:options.itemsPerPage},allowSelection:!0,selectionSettings:{selectionMode:[ej.Grid.SelectionMode.Row],enableToggle:!0},editSettings:{allowDeleting:!0,showDeleteConfirmDialog:!0},toolbarSettings:{showToolbar:!0,toolbarItems:[ej.Grid.ToolBarItems.Delete],customToolbarItems:[{templateID:"#viewMode"},"Refresh",{templateID:"#NewAd"},"Edit",{templateID:"#ModerateAd"},{templateID:"#UnModerateAd"},{templateID:"#TrashPlace"},{templateID:"#UnTrashPlace"}]},toolbarClick:function(t){var i=n(t.target),e=this.getSelectedRecords(),s,l,h,a,c,v;i.hasClass("Refresh")&&this.refreshContent();i.hasClass("Edit")?e.length>0&&(l=e[0].aid,document.location=options.editorUrl+l):i.hasClass("place-to-trash")||i.hasClass("place-from-trash")?(h=i.hasClass("place-to-trash")?1:0,e.length>0&&(a=parseInt(e[0].trash,10),s=parseInt(e[0].aid,10),a!=h&&n.post(ajaxurl,{action:"trash_ad",aid:s,trash:h,sam_pro_nonce:options.samProNonce,wap:options.wap}).done(function(){var n=parseInt(o.getSelectedValue(),10);n==0?u._disabledToolItems.push(f[8]):n==1&&u._disabledToolItems.push(f[7]);u.refreshContent()}))):(i.hasClass("ad-moderate")||i.hasClass("ad-unmoderate"))&&(c=i.hasClass("ad-moderate")?1:0,e.length>0&&(v=parseInt(e[0].moderated,10),s=parseInt(e[0].aid,10),v!=c&&n.post(r,{action:"moderate_ad",aid:s,mod:c,sam_pro_nonce:options.samProNonce,wap:options.wap}).done(function(){u.refreshContent()})))},create:function(){var i=n("#grid_toolbarItems");f=i.find("li");n(".place-to-trash").parent("li").attr("title",t.moveToTrash);n(".place-from-trash").parent("li").attr("title",t.restoreFromTrash);n(".ad-moderate").parent("li").attr("title",t.approve);n(".ad-unmoderate").parent("li").attr("title",t.cancelApproval);n("#view-mode").parent("li").attr("title",t.viewMode);n('li[title="NewAd"]').attr("title",t.newAd);n('li[title="Edit"]').attr("title",t.edit);n(".Refresh").parent("li").attr("title",t.refresh)},actionComplete:function(t){if(t.requestType=="refresh"){var r=n("#grid_toolbarItems"),i;i=n("#grid_delete");r.ejToolbar("disableItem",i);i=n("#grid_Edit");r.ejToolbar("disableItem",i);i=n("#grid_ModerateAd");r.ejToolbar("disableItem",i);i=n("#grid_UnModerateAd");r.ejToolbar("disableItem",i);i=n("#grid_TrashPlace");r.ejToolbar("disableItem",i);i=n("#grid_UnTrashPlace");r.ejToolbar("disableItem",i)}},recordClick:function(){var i=n("#grid_toolbarItems"),t,u=this.getSelectedRecords(),r=u.length==0?"disableItem":"enableItem";t=n("#grid_delete");i.ejToolbar(r,t);t=n("#grid_Edit");i.ejToolbar(r,t);t=n("#grid_ModerateAd");i.ejToolbar(r,t);t=n("#grid_UnModerateAd");i.ejToolbar(r,t);t=n("#grid_TrashPlace");i.ejToolbar(r,t);t=n("#grid_UnTrashPlace");i.ejToolbar(r,t)},columns:[{field:"aid",headerText:t.adId,isPrimaryKey:!0,textAlign:ej.TextAlign.Right,allowSorting:!0,allowEditing:!1,width:100},{field:"title",headerText:t.name,allowSorting:!0,allowEditing:!1,width:250},{field:"description",headerText:t.desc,allowSorting:!0,allowEditing:!1},{field:"asize",headerText:t.size,allowSorting:!0,allowEditing:!1,width:100},{field:"stat",headerText:t.status,textAlign:ej.TextAlign.Center,allowSorting:!1,allowEditing:!1,allowFiltering:!1,width:100},{field:"trash",headerText:"Status",allowEditing:!1,visible:!1}]}).data("ejGrid"),o=n("#view-mode").ejDropDownList({selectedItemIndex:0,change:function(){var t=parseInt(this.getSelectedValue(),10);t!=10?n("#grid").ejGrid("model.query",(new ej.Query).where("trash",ej.FilterOperators.equal,t,10)):n("#grid").ejGrid("model.query",new ej.Query);t==0?u._disabledToolItems.push(f[8]):t==1&&u._disabledToolItems.push(f[7]);u.refreshContent(!0)}}).data("ejDropDownList")})})(jQuery)