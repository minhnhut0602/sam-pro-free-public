'use strict';(function(a){var b=[],c=0,d=options.locale.changeLocale?options.locale.locale:'en-US',e=options.strings;a(document).ready(function(){function f(b){c=b,g=ej.DataManager({url:ajaxurl+'?action=list_ads&pid='+b+'&sam_pro_nonce='+options.samProNonce,requestType:'json',adaptor:new ej.UrlAdaptor}),h=a('#adsGrid').ejGrid({dataSource:g,locale:d,allowTextWrap:!0,allowPaging:!0,pageSettings:{pageSize:options.itemsPerPage},allowSorting:!0,allowSelection:!0,selectionType:ej.Grid.SelectionType.Multiple,selectionSettings:{selectionMode:[ej.Grid.SelectionMode.Row],enableToggle:!0},columns:[{field:'aid',headerText:e.adId,isPrimaryKey:!0,textAlign:ej.TextAlign.Right,width:120},{field:'title',headerText:e.name,width:280},{field:'description',headerText:e.desc},{field:'asize',headerText:e.size,width:100}],rowSelected:function rowSelected(a){if(!k.service){k.page=a.model.pageSettings.currentPage;var b=k.pids[k.page].slice(0),c=b.indexOf(a.data.aid);-1<c?k.removePid(a.data.aid):k.pids=a.data.aid}},actionComplete:function actionComplete(a){var b=k.ids.slice(0);if(k.service=!0,0!==b.length)for(var c=0;c<this.model.currentViewData.length;c++)for(var d=0;d<b.length;d++)b[d]===this.model.currentViewData[c].aid&&(this.multiSelectCtrlRequest=!0,this.selectRows(c),'paging'===a.requestType?(k.page=a.currentPage,k.pids=this.model.currentViewData[c].aid):'refresh'===a.requestType&&(k.page=1,k.pids=this.model.currentViewData[c].aid));k.service=!1}}).data('ejGrid'),k.sid='',i.open()}var g,h,i=a('#adsDialog').ejDialog({width:830,allowDraggable:!0,enableModal:!0,showOnInit:!1}).data('ejDialog'),k=new Selectors;a('#cancel-ads').on('click',function(){i.close(),h.destroy(),c=0}),a('#select-ads').on('click',function(){var b=k.sid;''!==b&&0!==c&&a.post(ajaxurl+'?action=link_ads',{pid:c,sid:b,sam_pro_nonce:options.samProNonce}).done(function(){return q.refreshContent()}),i.close(),h.destroy(),c=0});var j,l=ej.DataManager({url:ajaxurl+'?action=load_places&sam_pro_nonce='+options.samProNonce,removeUrl:ajaxurl+'?action=remove_place&sam_pro_nonce='+options.samProNonce,requestType:'json',adaptor:new ej.UrlAdaptor}),m=ej.DataManager({url:ajaxurl+'?action=load_places_ads&sam_pro_nonce='+options.samProNonce,removeUrl:ajaxurl+'?action=remove_place_ad&sam_pro_nonce='+options.samProNonce,updateUrl:ajaxurl+'?action=update_place_ad&sam_pro_nonce='+options.samProNonce,requestType:'json',adaptor:new ej.UrlAdaptor}),n=ej.DataManager({url:ajaxurl+'?action=lookup_ads&sam_pro_nonce='+options.samProNonce,requestType:'json',adaptor:new ej.UrlAdaptor,offline:!0}),o=ej.Query(),p=n.executeQuery(o);p.done(function(a){for(var c,d=a.result.count,e=a.result.result,f=0;f<d;f++)c={},c.text=e[f].aid+'. '+e[f].title,c.value=e[f].aid,b.push(c)});var q=a('#grid').ejGrid({dataSource:l,locale:d,allowTextWrap:!0,allowPaging:!0,pageSettings:{pageSize:options.itemsPerPage},allowSorting:!0,allowFiltering:!0,filterSettings:{filterType:'menu'},allowSelection:!0,selectionSettings:{selectionMode:[ej.Grid.SelectionMode.Row],enableToggle:!0},editSettings:{allowDeleting:!0,showDeleteConfirmDialog:!0},toolbarSettings:{showToolbar:!0,customToolbarItems:[{templateID:'#viewMode'},'Expand','Collapse','Refresh',{templateID:'#NewPlace'},'Edit','Link',{templateID:'#TrashPlace'},{templateID:'#UnTrashPlace'}],toolbarItems:[ej.Grid.ToolBarItems.Delete]},actionComplete:function actionComplete(){var b,c=a('#grid_toolbarItems');b=a('#grid_delete'),c.ejToolbar('disableItem',b),b=a('#grid_Edit'),c.ejToolbar('disableItem',b),b=a('#grid_Link'),c.ejToolbar('disableItem',b),b=a('#grid_TrashPlace'),c.ejToolbar('disableItem',b),b=a('#grid_UnTrashPlace'),c.ejToolbar('disableItem',b)},recordClick:function recordClick(){var b,c=a('#grid_toolbarItems'),d=this.getSelectedRecords(),e=0===d.length?'disableItem':'enableItem';b=a('#grid_delete'),c.ejToolbar(e,b),b=a('#grid_Edit'),c.ejToolbar(e,b),b=a('#grid_Link'),c.ejToolbar(e,b),b=a('#grid_TrashPlace'),c.ejToolbar(e,b),b=a('#grid_UnTrashPlace'),c.ejToolbar(e,b)},toolbarClick:function toolbarClick(b){var c=a(b.target),d=this.getSelectedRecords();if(c.hasClass('Expand'))this.expandAll();else if(c.hasClass('Collapse'))this.collapseAll();else if(c.hasClass('Refresh')){var e=parseInt(r.getSelectedValue(),10);0===e?q._disabledToolItems.push(j[6]):1===e&&q._disabledToolItems.push(j[5]),this.refreshContent()}else if(c.hasClass('Edit')){if(0<d.length){var g=d[0].pid;document.location=options.editorUrl+g}}else if(c.hasClass('place-to-trash')||c.hasClass('place-from-trash')){var h=c.hasClass('place-to-trash')?1:0;if(0<d.length){var i=parseInt(d[0].pid,10),k=parseInt(d[0].trash,10);k!==h&&a.post(ajaxurl,{action:'trash_place',pid:i,trash:h,sam_pro_nonce:options.samProNonce}).done(function(){var a=parseInt(r.getSelectedValue(),10);0===a?q._disabledToolItems.push(j[6]):1===a&&q._disabledToolItems.push(j[5]),q.refreshContent()})}}else if(c.hasClass('Link')&&-1!==b.model.selectedRowIndex){var l=b.model.currentViewData[b.model.selectedRowIndex].pid;f(l)}},columns:[{field:'pid',headerText:e.id,isPrimaryKey:!0,foreignKeyField:'pid',textAlign:ej.TextAlign.Right,width:120},{field:'title',headerText:e.name,width:250},{field:'description',headerText:e.desc},{field:'psize',headerText:e.size,width:200},{field:'stat',headerText:e.status,textAlign:ej.TextAlign.Center,allowFiltering:!1,width:100},{field:'trash',headerText:'Trash',visible:!1}],create:function create(){var b=a('#grid_toolbarItems');j=b.find('li'),a('.Expand').parent('li').attr('title',e.expand),a('.Collapse').parent('li').attr('title',e.collapse),a('.Refresh').parent('li').attr('title',e.refresh),a('.Edit').parent('li').attr('title',e.edit),a('#view-mode').parent('li').attr('title',e.viewMode),a('.place-to-trash').parent('li').attr('title',e.moveToTrash),a('.place-from-trash').parent('li').attr('title',e.restoreFromTrash),a('.new-ad').parent('li').attr('title',e.newPlace),a('.Link').parent('li').attr('title',e.linkAds)},childGrid:{dataSource:m,locale:d,queryString:'pid',allowSorting:!1,allowSelection:!0,selectionSettings:{selectionMode:[ej.Grid.SelectionMode.Row],enableToggle:!0},editSettings:{allowEditing:!0,allowDeleting:!0,showDeleteConfirmDialog:!0},toolbarSettings:{showToolbar:!0,toolbarItems:['edit',ej.Grid.ToolBarItems.Update,ej.Grid.ToolBarItems.Cancel],customToolbarItems:[{templateID:'#Trash'},'Edit_Ad']},columns:[{field:'pid',headerText:'Place ID',isPrimaryKey:!0,visible:!1},{field:'aid',headerText:e.adId,isPrimaryKey:!0,allowEditing:!1,textAlign:ej.TextAlign.Right,width:100},{field:'title',headerText:e.name,allowEditing:!1,width:250},{field:'description',headerText:e.desc,allowEditing:!1},{field:'weight',headerText:e.weight,textAlign:ej.TextAlign.Right,allowEditing:!0,editType:ej.Grid.EditingType.Numeric,defaultValue:10,width:150},{field:'trash',headerText:e.status,allowEditing:!1,textAlign:ej.TextAlign.Center,width:100}],create:function create(){a('.to-trash').parent('li').attr('title',e.unlinkAd),a('.Edit_Ad').parent('li').attr('title',e.editAd)},actionComplete:function actionComplete(){var b,c=a('#'+this._id+'_toolbarItems');b=a('#'+this._id+'_Trash'),c.ejToolbar('disableItem',b),b=a('#'+this._id+'_Edit_Ad'),c.ejToolbar('disableItem',b)},recordClick:function recordClick(){var b,c=a('#'+this._id+'_toolbarItems'),d=this.getSelectedRecords(),e=0===d.length?'disableItem':'enableItem';b=a('#'+this._id+'_Trash'),c.ejToolbar(e,b),b=a('#'+this._id+'_Edit_Ad'),c.ejToolbar(e,b)},toolbarClick:function toolbarClick(b){var c=a(b.target),d=this.getSelectedRecords();if(c.hasClass('to-trash'))a.post(ajaxurl+'?action=unlink_ad',{pid:b.model.currentViewData[b.model.selectedRowIndex].pid,aid:b.model.currentViewData[b.model.selectedRowIndex].aid,sam_pro_nonce:options.samProNonce}).done(function(a){a.success&&q.refreshContent()});else if(c.hasClass('Edit_Ad')&&0<d.length){var e=d[0].aid;document.location=options.adEditorUrl+e}}}}).data('ejGrid'),r=a('#view-mode').ejDropDownList({selectedItemIndex:0,change:function change(){var b=parseInt(this.getSelectedValue(),10);10===b?a('#grid').ejGrid('model.query',new ej.Query):a('#grid').ejGrid('model.query',new ej.Query().where('trash',ej.FilterOperators.equal,b,10)),0===b?q._disabledToolItems.push(j[6]):1===b&&q._disabledToolItems.push(j[5]),q.refreshContent(!0)}}).data('ejDropDownList')})})(jQuery);

//# sourceMappingURL=sam.pro.places.list.min.js.map